
<div class="container-md" >  
    <div class="escasan-dialog" *ngIf="esModal">
        <div class="btn-contenedor-custom" >
            <button class="close-button custom-cerrar" [mat-dialog-close]="true">
              <mat-icon class="close-icon" color="warn">close</mat-icon>
            </button>
          </div>
    </div>
    
    <div class="container">
        <form autocomplete="off" [formGroup]="val.ValForm">
        <div class="card">
            <div class="card-header card-escasan-header opcional"> Datos Ejercicio Fiscal..</div>
            <div class="card-body">

                <div class="row">
                    <div class="col-9 mb-1">
                        <div  class="input-group">
                            <span class="input-group-text"><i class="fa-regular fa-file fa-beat-fade"></i></span>
                            <div class="form-floating">
                                <input type="text" class="form-control" id="idEjercicioFiscal" placeholder="Ejercicio Fiscal" formControlName="idEjercicioFiscal">
                                <label for="idEjercicioFiscal">Ejercicio Fiscal:</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-12 col-md-12 col-lg-3 mb-3">
                        <div class="row justify-content-md-center">
                            <div class="bloqueada">
                                <div class="contenedor ">
                                    <label> Estado </label>                                    
                                        <input type="checkbox" checked data-toggle="toggle" data-style="on" data-onstyle="on" 
                                            data-offstyle="off" data-onlabel="ABIERTO" data-offlabel="CERRADO" data-width="120"
                                            id="chkBloqueadaEF" formControlName="chkBloqueadaEF" 
                                            (change)="v_Bloqueada($event)">
                                </div>                        
                            </div>
                        </div>
                    </div>
                    
                </div>
                <div class="row">               
                    <div class="col-12 col-md-12 col-lg-6 mb-1">
                        <div  class="input-group">
                            <span class="input-group-text"><i class="fa-solid fa-calendar-days fa-beat-fade fa-lg"></i></span>
                            <div class="form-floating"> 
                                <input type="text"  mask="0000"  class="form-control" id="idFechaIni" 
                                formControlName="idFechaIni" (keyup)="fill_Table()" placeholder="Fecha Inicio Ejercicio Fiscal" min="2020" max="2030">
                                <label for="idFechaIni">Fecha Inicio</label>
                            </div>
                        </div>
                    </div>
                    

                    <!-- <div class="col-12 col-md-12 col-lg-6 mb-1">
                        <div class="row mb-1">
                            <div class="input-group">
                                <span class="input-group-text"><i class="fa-regular fa-newspaper fa-beat-fade fa-lg"></i></span>
                                <div class="form-floating">
                                    <div>
                                        <div class="form-floating">
                                            <input type="text" class="form-control" placeholder="Cuenta"
                                                id="txtCuentaA" formControlName="txtCuentaA"
                                                [matAutocomplete]="cmbPadre">
                                            <label for="txtCuentaA">Cuenta Acumulada</label>
                                        </div>
                                                                         
                                        <mat-autocomplete autoActiveFirstOption #cmbPadre="matAutocomplete"
                                        (optionSelected)="v_Select_Cuenta($event)">
                                        <mat-option *ngFor="let option of filteredCuenta1 | async" [value]="option.Filtro">
                                            {{option.Filtro}}
                                        </mat-option>
                                    </mat-autocomplete>
                                    </div>                                    
                                </div>
                            </div>
                        </div>
                    </div> -->
                    <div class="col-12 col-md-12 col-lg-6 mb-1">
                        <igx-combo #cmbCuenta [data]="lstCuenta" valueKey="CuentaContable" displayKey="NombreCuenta" id="cmbCuenta"
                                        formControlName="cmbCuenta" placeholder="Cuenta Acumulada"
                                        searchPlaceholder="Seleccione una Cuenta..." [autoFocusSearch]="true"
                                        [overlaySettings]="overlaySettings" (selectionChanging)="v_Select_Cuenta($event)" 
                                        (keyup)="v_Enter_Cuenta($event);">
                                        <label igxLabel>Cuenta Acumulada</label>
                                        <igx-prefix><i class="bi bi-shop fa-lg"></i></igx-prefix>
                        </igx-combo>
                    </div>

                    <div class="col-12 col-md-12 col-lg-6 mb-1">
                        <igx-combo #cmbCuenta2 [data]="lstCuenta" valueKey="CuentaContable" displayKey="NombreCuenta" id="cmbCuenta2"
                                        formControlName="cmbCuenta2" placeholder="Utilidad Perdida"
                                        searchPlaceholder="Seleccione una Cuenta..." [autoFocusSearch]="true"
                                        [overlaySettings]="overlaySettings" (selectionChanging)="v_Select_Cuenta2($event)"
                                        (keyup)="v_Enter_Cuenta2($event);">
                                        <label igxLabel>Utilidad Perdida</label>
                                        <igx-prefix><i class="bi bi-shop fa-lg"></i></igx-prefix>
                        </igx-combo>
                    </div>

                    <div class="col-12 col-md-12 col-lg-6 mb-3">
                        <igx-combo #cmbCuenta3 [data]="lstCuenta" valueKey="CuentaContable" displayKey="NombreCuenta" id="cmbCuenta3"
                                        formControlName="cmbCuenta3" placeholder="Utilidad Periodo"
                                        searchPlaceholder="Seleccione una Cuenta..." [autoFocusSearch]="true"
                                        [overlaySettings]="overlaySettings" (selectionChanging)="v_Select_Cuenta3($event)"
                                        (keyup)="v_Enter_Cuenta3($event);">
                                        <label igxLabel>Utilidad Periodo</label>
                                        <igx-prefix><i class="bi bi-shop fa-lg"></i></igx-prefix>
                        </igx-combo>
                    </div>

                    <!-- <div class="col-12 col-md-12 col-lg-6 mb-1">
                        <div class="row mb-1">
                            <div class="input-group">
                                <span class="input-group-text"><i class="fa-regular fa-newspaper fa-beat-fade fa-lg"></i></span>
                                <div class="form-floating">
                                    <div>
                                        <div class="form-floating">
                                            <input type="text" class="form-control" placeholder="Cuenta"
                                                id="txtCuentaP" formControlName="txtCuentaP"
                                                [matAutocomplete]="cmbPadre2">
                                            <label for="txtCuentaP">Utilidad Perdida</label>
                                        </div>
                                                                         
                                        <mat-autocomplete autoActiveFirstOption #cmbPadre2="matAutocomplete"
                                        (optionSelected)="v_Select_Cuenta($event)">
                                        <mat-option *ngFor="let option of filteredCuenta2 | async" [value]="option.Filtro">
                                            {{option.Filtro}}
                                        </mat-option>
                                    </mat-autocomplete>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->
                    
                   

                    <!-- <div class="col-12 col-md-12 col-lg-6 mb-1">
                        <div class="row mb-1">
                            <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-arrow-down-wide-short fa-beat-fade fa-lg"></i></span>
                                <div class="form-floating">
                                    <div>
                                        <div class="form-floating">
                                            <input type="text" class="form-control" placeholder="Cuenta"
                                                id="txtCuentaPr" formControlName="txtCuentaPr"
                                                [matAutocomplete]="cmbPadre3">
                                            <label for="txtCuentaPr">Utilidad Periodo</label>
                                        </div>
                                                                         
                                        <mat-autocomplete autoActiveFirstOption #cmbPadre3="matAutocomplete"
                                        (optionSelected)="v_Select_Cuenta($event)">
                                        <mat-option *ngFor="let option of filteredCuenta3 | async" [value]="option.Filtro">
                                            {{option.Filtro}}
                                        </mat-option>
                                    </mat-autocomplete>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->


                    <!-- <div class="row">
                        <div class="btn-contenedor d-grid gap-2 d-md-flex justify-content-md-end mb-3">                            
                            <span>
                                <button type="button" class="btn btn-secundario" id="btnPeriodos" (click)="fill_Table()"><i class="fa-solid fa-eye fa-beat-fade fa-lg"></i> Ver Periodos</button>
                            </span>
                        </div>
                    </div> -->
                </div>

                <div class="mat-elevation-z8  table-container">

    
                    <table class="table table-hover  table-sm tabla-layout mat-elevation-z8" mat-table [dataSource]="lstPeriodo">                           
                       
                         <!-- Position Column -->
                        <ng-container matColumnDef="NoPeriodo">
                            <th mat-header-cell *matHeaderCellDef> N° Periodo. </th>
                            <td mat-cell *matCellDef="let det"> {{det.NoPeriodo}} </td>
                        </ng-container>
                    
                        <!-- Name Column -->
                        <ng-container matColumnDef="NombrePeriodo">
                            <th mat-header-cell *matHeaderCellDef> Nombre Periodo </th>
                            <td mat-cell *matCellDef="let det"> {{det.NombrePeriodo}} </td>
                        </ng-container>
                    
                        <!-- Weight Column -->
                        <ng-container matColumnDef="ClasePeriodo">
                            <th mat-header-cell *matHeaderCellDef> Clase Periodo </th>
                            <td mat-cell *matCellDef="let det"> {{det.ClasePeriodo}} </td>
                        </ng-container>
                    
                        <!-- Symbol Column -->
                        <ng-container matColumnDef="FechaPeridoI">
                            <th mat-header-cell *matHeaderCellDef> Fecha Inicial </th>
                            <td mat-cell *matCellDef="let det"> {{det.FechaInicio | date : 'dd-MM-yyyy'}} </td>
                        </ng-container>

                        <!-- Weight Column -->
                        <ng-container matColumnDef="FechaPeridoF">
                            <th mat-header-cell *matHeaderCellDef> Fecha Final </th>
                            <td mat-cell *matCellDef="let det"> {{det.FechaFinal | date : 'dd-MM-yyyy'}} </td>
                        </ng-container>
                    
                        <!-- Symbol Column -->
                        <ng-container matColumnDef="Estado">
                            <th mat-header-cell *matHeaderCellDef> Estado </th>
                            <td mat-cell *matCellDef="let det"> {{det.Estado}}                                 
                            </td>
                        </ng-container>

                        <ng-container matColumnDef="Icon">
                            <th mat-header-cell *matHeaderCellDef> Accion </th>
                            <td mat-cell *matCellDef="let det">  
                                <button class="btn btn-opcional" (click)="E_ditar(det)">
                                    <i [ngClass]="det.Estado == 'ABIERTO' ? 'fas fa-lock-open fa-lg' : 'fas fa-lock fa-lg'  "></i>
                                </button>
                            </td>
                        </ng-container>

                                               
                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="linea-bottom-secundario dashed"></tr>
            
           
                    </table>
                                    
                  
                </div>

            
                <div class="contenedor-pie">
                    <div class="pie-asiento">
                        <div class="row mt-6 botones linea-top-secundario">
                            <div class="col-12 col-md-12 col-lg-6 mb-3">                     
                                    <button type="button" class="btn btn-secundario" id="btnRefrescar"  (click)="v_CargarDatos();"><i class="fa-solid fa-arrows-rotate fa-spin fa-lg"></i> Refrescar</button>
                            </div>   

                            <div class="col-12 col-md-12 col-lg-6">
                                <div class="btn-contenedor">
                                    <button type="button" class="btn btn-primario" id="btnGuardarEjercicioF" (click)="v_Guardar()"><i class="fa-solid fa-floppy-disk fa-beat-fade fa-lg"></i> Guardar</button>
                                    <button type="button" class="btn btn-opcional" id="btnCancelarEjercicioF" (click)="v_Evento('Limpiar');" *ngIf="!esModal"><i class="fa-solid fa-arrow-left fa-beat fa-lg"></i> Cancelar</button>
                
                                </div>
                            </div>
                        </div>
                    </div>
                </div>             
            </div>
        </div>
        </form>
    </div>
</div>








